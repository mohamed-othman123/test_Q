<div class="page-header">
  @if (mode !== 'view') {
    <h2>
      {{
      isEditingElement
      ? ('expensesItems.updateExpenseElement' | translate)
      : ('expensesItems.addExpenseElement' | translate)
      }}
    </h2>
  } @else {
    <h2>
      {{ 'expensesItems.expenseElements' | translate }}
    </h2>
  }

</div>

@if (mode !== 'view') {
  <form
    [formGroup]="elementForm"
    appShakeable
    (ngSubmit)="submit()"
    >
    <div class="row d-flex align-items-baseline">
      <div class="col-md-4">
        <app-input
          [control]="getControl('nameAr')"
          [controlName]="'nameAr'"
          inputType="text"
          [placeholder]="'expensesItems.expenseElementArPlaceholder' | translate"
          [label]="'expensesItems.expenseElementAr' | translate">
          <i class="pi pi-pencil" style="color: gray"></i>
        </app-input>
      </div>
      <div class="col-md-4">
        <app-input
          [control]="getControl('name')"
          [controlName]="'name'"
          inputType="text"
          [placeholder]="'expensesItems.expenseElementEnPlaceholder' | translate"
          [label]="'expensesItems.expenseElementEn' | translate">
          <i class="pi pi-pencil" style="color: gray"></i>
        </app-input>
      </div>
      <div class="col-md-4">
        <app-input
          [control]="getControl('value')"
          [controlName]="'value'"
          inputType="number"
        [placeholder]="
          'expensesItems.expenseElementValuePlaceholder' | translate
        "
          [label]="'expensesItems.expenseElementValue' | translate">
          <i class="sar-icon" style="color: gray"></i>
        </app-input>
      </div>
    </div>
    <!--form action-->
    <div class="button-group">
      @if (!isEditingElement) {
        <p-button
          type="submit"
          [icon]="'pi pi-plus'"
          label="{{ 'expensesItems.addNewExpenseElement' | translate }}"
          styleClass="w-auto">
        </p-button>
      }
      @if (isEditingElement) {
        <p-button
          type="submit"
          [icon]="'pi pi-check'"
          label="{{ 'common.update' | translate }}"
          styleClass="w-auto p-button-success">
        </p-button>
        <p-button
          type="button"
          [icon]="'pi pi-times'"
          (onClick)="cancelEdit()"
          label="{{ 'common.cancel' | translate }}"
          styleClass="w-auto p-button-secondary">
        </p-button>
      }
    </div>
  </form>
}

<!--expense element table-->
<p-table
  [paginator]="elements.value?.length > 5"
  [rows]="5"
  [rowsPerPageOptions]="[5, 10, 25]"
  [value]="elements.value"
  [tableStyle]="{'min-width': '50rem'}">
  <ng-template pTemplate="header">
    @if (elements.value.length > 0) {
      <tr>
        <th>{{ 'expensesItems.expenseElement' | translate }}</th>
        <th>{{ 'expensesItems.expenseElementValue' | translate }}</th>
        <th style="width: fit-content"></th>
      </tr>
    }
  </ng-template>
  <ng-template pTemplate="body" let-element let-rowIndex="rowIndex">
    <tr>
      <td>{{ lang.lang === 'ar' ? element.nameAr : element.name }}</td>
      <td>
        <span class="price-with-symbol">
          <sar-symbol />
          <span>
            {{ element.value }}
          </span>
        </span>
      </td>
      <td>
        @if (mode !== 'view') {
          <div style="margin-top: 0; justify-content: unset" class="actions">
            <div
              (click)="editExpenseElement(rowIndex)"
              class="action-button edit">
              <i class="pi pi-pencil"></i>
              <span>{{ 'common.edit' | translate }}</span>
            </div>
            <div
              appConfirmDeleteDialog
              [deletedItem]="'expensesItems.expenseElement' | translate"
              (acceptDelete)="deleteExpenseElement(rowIndex)"
              class="action-button delete">
              <i class="pi pi-trash"></i>
              <span>{{ 'common.delete' | translate }}</span>
            </div>
          </div>
        }
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <app-empty-state
        [customMessage]="'expensesItems.noElementsYet' | translate">
      </app-empty-state>
    </tr>
  </ng-template>
</p-table>
